<html>
<head>
	<title>Lingua: Chat</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/svg" href="/images/favicon.svg"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="/css/index.css">
  <link rel="stylesheet" href="/css/chat.css">
  <script src="/js/chatinitialize.js"></script>
</head>
<body>

<ul>
  <li id="logo"><a><img src="/images/logo.svg" class="img-responsive"></a></li>
  <li><a href="/index"><img src="/images/learn.svg" class="img-responsive"></a></li>
  <li><a href="/chatroom"><img src="/images/chat_fill.svg" class="img-responsive"></a></li>
  <li><a href="/help"><img src="/images/help.svg" class="img-responsive"></a></li>
  <li id="profile"><a href="/profile"><img src="/images/profile.svg" class="img-responsive"></a></li>
</ul>

<!--add title of screen-->
<div style="background-color: #333333; overflow:auto; margin-top: 20px; margin-left: 5%; margin-right: 5%; padding: 3% 5%;">
<h4 id="chatname"style="color: white; text-align: left; margin: 5px 0">{{chatname}}</h4></div>
<div class="main" id = "chatcontent" style="background-color: #f1f1f1; overflow:auto;">
  <div id="chattopic"></div> <!--dynamically generated jquery code in javascript-->
</div>

<div id="levelChat" style="background-color: #333333; overflow:auto; margin-left: 5%; margin-right: 5%; padding: 3% 5%; display:none">
	<form role="form" method="get" action="/add" style="margin: 10px 0px;">
    <form name="message" role="form" method="get" action="/add">
      <input name="usermsg" type="text" style="width: 80%;" id="usermsg" placeholder="Chat message" maxlength = "60" required/>
      <input type="hidden" name="chattype" value="level" />
      <input type="hidden" name="username" id= "username" value="" />
      <input type="hidden" name="userimg" id="userimg" value="" />
      <!--<img src="/images/chatpic.svg" style="width: 7%; margin:0;"alt="">
      <img src="/images/chatmic.svg" style="width: 7%; margin:0;"alt="">-->
      <input name="submitmsg" type="submit" id="submitmsg" value="Send" />
  </form>
</div>

<div id="genChat" style="background-color: #333333; overflow:auto; margin-left: 5%; margin-right: 5%; padding: 3% 5%; display:none">
	<form role="form" method="get" action="/add" style="margin: 10px 0px;">
    <form name="message" role="form" method="get" action="/add">
      <input name="usermsg" type="text" style="width: 80%;" id="usermsg" placeholder="Chat message" maxlength = "60" required/>
      <input type="hidden" name="chattype" value="general" />
      <input type="hidden" name="username" id= "username2" value="" />
      <input type="hidden" name="userimg" id= "userimg2" value="" />
      <!--<img src="/images/chatpic.svg" style="width: 7%; margin:0;"alt="">
      <img src="/images/chatmic.svg" style="width: 7%; margin:0;"alt="">-->
      <input name="submitmsg" type="submit" id="submitmsg" value="Send" />
  </form>
</div>

</body>

<script>
  /** Sample chatroom preloaded conversation 1 (designed for Beginner Conversation) **/
  if(document.getElementById('chatname').innerHTML.includes("Grammar") || document.getElementById('chatname').innerHTML.includes("Conversation") || document.getElementById('chatname').innerHTML.includes("Vocabulary")){
    var projectHTML = "{{#each BeginnerConvChat}}<div class={{theme}}><img src={{image}} class={{imgPos}}><p> <a id='text'>{{name}}: </a>{{text}}</p><span class={{timePos}}>{{time}}</span></div>{{/each}}";
    $("#chattopic").html(projectHTML);
    document.getElementById("levelChat").style.display = "block";
  }
  else{
  /** Sample chatroom preloaded conversation 2 (designed for Food) **/
    var projectHTML = "{{#each FoodChat}}<div class={{theme}}><img src={{image}} class={{imgPos}}><p> <a id='text'>{{name}}: </a>{{text}}</p><span class={{timePos}}>{{time}}</span></div>{{/each}}";
    $("#chattopic").html(projectHTML);
    document.getElementById("genChat").style.display = "block";
  }
  window.onload = (event) => {
    $('#username').val(localStorage.getItem('username'));
    $('#userimg').val(localStorage.getItem('userpic'));
    $('#username2').val(localStorage.getItem('username'));
    $('#userimg2').val(localStorage.getItem('userpic'));
  };
</script>
</html>
